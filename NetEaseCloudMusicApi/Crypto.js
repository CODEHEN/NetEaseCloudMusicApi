"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var CryptoJS = require("./Libary/crypto-js");
var BigInt = require("./Libary/BigInteger.js");
var Crypto = (function () {
    function Crypto(originData) {
        this.firstKey = '0CoJUm6Qyw8W8jud';
        this.aes_mv = '0102030405060708';
        this.secondKey = "";
        this.modulus = '00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7';
        this.pubKey = '010001';
        this.originData = originData;
        this.cryptoResult = this.encrypt(this.originData);
    }
    Crypto.prototype.getCryptoResult = function () {
        return this.cryptoResult;
    };
    Crypto.prototype.createSecretKey = function (size) {
        if (size === void 0) { size = 16; }
        var keys = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        var key = "";
        for (var i = 0; i < size; i++) {
            var pos = Math.random() * keys.length;
            pos = Math.floor(pos);
            key = key + keys.charAt(pos);
        }
        return key;
    };
    Crypto.prototype.aesEncrypt = function (word, secKey) {
        var key = CryptoJS.enc.Utf8.parse(secKey);
        var iv = CryptoJS.enc.Utf8.parse(this.aes_mv);
        var srcs = CryptoJS.enc.Utf8.parse(word);
        var encrypted = CryptoJS.AES.encrypt(srcs, key, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 });
        var res = encrypted.toString();
        console.log(res);
        return res;
    };
    Crypto.prototype.zfill = function (str, size) {
        while (str.length < size)
            str = "0" + str;
        return str;
    };
    Crypto.prototype.rsaEncrypt = function (text, pubKey, modulus) {
        var _text = text.split('').reverse().join('');
        var biText = BigInt(CryptoJS.enc.Utf8.parse(_text).toString(), 16), biEx = BigInt(pubKey, 16), biMod = BigInt(modulus, 16), biRet = biText.modPow(biEx, biMod);
        return this.zfill(biRet.toString(16), 256);
    };
    Crypto.prototype.encrypt = function (obj) {
        var text = JSON.stringify(obj);
        var secKey = this.createSecretKey(16);
        var firstRes = this.aesEncrypt(text, this.firstKey);
        var secondRes = this.aesEncrypt(firstRes, secKey);
        var encSecKey = this.rsaEncrypt(secKey, this.pubKey, this.modulus);
        return {
            params: secondRes,
            encSecKey: encSecKey
        };
    };
    return Crypto;
}());
exports.Crypto = Crypto;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3J5cHRvLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQ3J5cHRvLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsNkNBQWdEO0FBQ2hELCtDQUFrRDtBQUVsRDtJQWtCSSxnQkFBWSxVQUFjO1FBaEJqQixhQUFRLEdBQVUsa0JBQWtCLENBQUM7UUFDckMsV0FBTSxHQUFVLGtCQUFrQixDQUFDO1FBQzVDLGNBQVMsR0FBVSxFQUFFLENBQUM7UUFHYixZQUFPLEdBQVUsb1FBQW9RLENBQUE7UUFDclIsV0FBTSxHQUFVLFFBQVEsQ0FBRTtRQVcvQixJQUFJLENBQUMsVUFBVSxHQUFDLFVBQVUsQ0FBQztRQUMzQixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3RELENBQUM7SUFLRCxnQ0FBZSxHQUFmO1FBQ0ksT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBQzdCLENBQUM7SUFNRCxnQ0FBZSxHQUFmLFVBQWdCLElBQVM7UUFBVCxxQkFBQSxFQUFBLFNBQVM7UUFDckIsSUFBTSxJQUFJLEdBQUcsZ0VBQWdFLENBQUM7UUFDOUUsSUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFDO1FBQ2IsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUMzQixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztZQUN0QyxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUN0QixHQUFHLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDaEM7UUFDRCxPQUFPLEdBQUcsQ0FBQztJQUNmLENBQUM7SUFPRCwyQkFBVSxHQUFWLFVBQVcsSUFBSSxFQUFFLE1BQU07UUFDbkIsSUFBSSxHQUFHLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzFDLElBQUksRUFBRSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUMsSUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3pDLElBQUksU0FBUyxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBQ2xILElBQUksR0FBRyxHQUFHLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUMvQixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pCLE9BQU8sR0FBRyxDQUFDO0lBQ2YsQ0FBQztJQU9ELHNCQUFLLEdBQUwsVUFBTSxHQUFHLEVBQUUsSUFBSTtRQUNYLE9BQU8sR0FBRyxDQUFDLE1BQU0sR0FBRyxJQUFJO1lBQUUsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUM7UUFDMUMsT0FBTyxHQUFHLENBQUM7SUFDZixDQUFDO0lBUUQsMkJBQVUsR0FBVixVQUFXLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTztRQUM1QixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNoRCxJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUNoRSxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsRUFDekIsS0FBSyxHQUFHLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLEVBQzNCLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN2QyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBTUQsd0JBQU8sR0FBUCxVQUFRLEdBQUc7UUFDUCxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pDLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDeEMsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3BELElBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3BELElBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3JFLE9BQU87WUFDSCxNQUFNLEVBQUUsU0FBUztZQUNqQixTQUFTLEVBQUUsU0FBUztTQUN2QixDQUFBO0lBQ0wsQ0FBQztJQUNMLGFBQUM7QUFBRCxDQUFDLEFBcEdELElBb0dDO0FBcEdZLHdCQUFNIiwic291cmNlc0NvbnRlbnQiOlsiLy8g5Yqg5a+G57G7XHJcbmltcG9ydCBDcnlwdG9KUyA9IHJlcXVpcmUoXCIuL0xpYmFyeS9jcnlwdG8tanNcIik7ICAgICAgLy8g5Yqg5a+G57G75bqTXHJcbmltcG9ydCBCaWdJbnQgPSByZXF1aXJlKFwiLi9MaWJhcnkvQmlnSW50ZWdlci5qc1wiKTsgIC8vIOWkp+aVsOexu+W6k1xyXG5cclxuZXhwb3J0IGNsYXNzIENyeXB0b3tcclxuICAgIC8vIEFFU+WKoOWvhlxyXG4gICAgcmVhZG9ubHkgZmlyc3RLZXk6c3RyaW5nID0gJzBDb0pVbTZReXc4VzhqdWQnOyAgIC8vIGFlc+esrOS4gOasoeWKoOWvhuenmOmSpeS4uu+8jOWbuuWumlxyXG4gICAgcmVhZG9ubHkgYWVzX212OnN0cmluZyA9ICcwMTAyMDMwNDA1MDYwNzA4JzsgICAgIC8vIGFlc+WBj+enu++8jOWbuuWumlxyXG4gICAgc2Vjb25kS2V5OnN0cmluZyA9IFwiXCI7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWVz56ys5LqM5qyh5Yqg5a+G56eY6ZKl5Zyo5Yqg5a+G5pe26ZqP5py66I635Y+WXHJcblxyXG4gICAgLy8gUlNB5Yqg5a+GXHJcbiAgICByZWFkb25seSBtb2R1bHVzOnN0cmluZyA9ICcwMGUwYjUwOWY2MjU5ZGY4NjQyZGJjMzU2NjI5MDE0NzdkZjIyNjc3ZWMxNTJiNWZmNjhhY2U2MTViYjdiNzI1MTUyYjNhYjE3YTg3NmFlYThhNWFhNzZkMmU0MTc2MjllYzRlZTM0MWY1NjEzNWZjY2Y2OTUyODAxMDRlMDMxMmVjYmRhOTI1NTdjOTM4NzAxMTRhZjZjOWQwNWM0ZjdmMGMzNjg1YjdhNDZiZWUyNTU5MzI1NzVjY2UxMGI0MjRkODEzY2ZlNDg3NWQzZTgyMDQ3Yjk3ZGRlZjUyNzQxZDU0NmI4ZTI4OWRjNjkzNWIzZWNlMDQ2MmRiMGEyMmI4ZTcnXHJcbiAgICByZWFkb25seSBwdWJLZXk6c3RyaW5nID0gJzAxMDAwMScgOyAgICAgICAgLy8gcnNh5YWs6ZKlXHJcblxyXG4gICAgLy8gbXVzaWNTZWFyY2hSZXN1bHQ6YW55PW51bGw7ICAvLyDmrYzmm7Lmn6Xmib7nu5PmnpxcclxuICAgIG9yaWdpbkRhdGE6YW55OyAgICAgICAgICAgICAvLyDliqDlr4bliY3mlbDmja5cclxuICAgIGNyeXB0b1Jlc3VsdDphbnk7ICAgICAgICAgICAvLyDliqDlr4bnu5PmnpwgIFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p6E6YCg5Ye95pWw77yM5Lyg5YWl6ZyA6KaB5Yqg5a+G55qE5pWw5o2u77yMXHJcbiAgICAgKiBAcGFyYW0gb3JpZ2luRGF0YSDljp/lp4vmlbDmja5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3Iob3JpZ2luRGF0YTphbnkpe1xyXG4gICAgICAgIHRoaXMub3JpZ2luRGF0YT1vcmlnaW5EYXRhO1xyXG4gICAgICAgIHRoaXMuY3J5cHRvUmVzdWx0ID0gdGhpcy5lbmNyeXB0KHRoaXMub3JpZ2luRGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bliqDlr4bnu5PmnpxcclxuICAgICAqL1xyXG4gICAgZ2V0Q3J5cHRvUmVzdWx0KCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3J5cHRvUmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog55Sf5oiQ6ZqP5py65pWw77yMc2l6Zem7mOiupDE2XHJcbiAgICAgKiBAcGFyYW0gc2l6ZSBcclxuICAgICAqL1xyXG4gICAgY3JlYXRlU2VjcmV0S2V5KHNpemUgPSAxNikge1xyXG4gICAgICAgIGNvbnN0IGtleXMgPSBcImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5XCI7XHJcbiAgICAgICAgbGV0IGtleSA9IFwiXCI7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IHBvcyA9IE1hdGgucmFuZG9tKCkgKiBrZXlzLmxlbmd0aDtcclxuICAgICAgICAgICAgcG9zID0gTWF0aC5mbG9vcihwb3MpO1xyXG4gICAgICAgICAgICBrZXkgPSBrZXkgKyBrZXlzLmNoYXJBdChwb3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIOS9v+eUqEFFU+WKoOWvhuWSjEJBU0U2NOe8lueggVxyXG4gICAgICogQHBhcmFtIHdvcmQg5Yqg5a+G55qE5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gc2VjS2V5IOWKoOWvhuWvhumSpVxyXG4gICAgICovXHJcbiAgICBhZXNFbmNyeXB0KHdvcmQsIHNlY0tleSkge1xyXG4gICAgICAgIGxldCBrZXkgPSBDcnlwdG9KUy5lbmMuVXRmOC5wYXJzZShzZWNLZXkpOyAgLy/ljYHlha3kvY3ljYHlha3ov5vliLbmlbDkvZzkuLrlr4bpkqVcclxuICAgICAgICBsZXQgaXYgPSBDcnlwdG9KUy5lbmMuVXRmOC5wYXJzZSh0aGlzLmFlc19tdik7ICAgLy/ljYHlha3kvY3ljYHlha3ov5vliLbmlbDkvZzkuLrlr4bpkqXlgY/np7vph49cclxuICAgICAgICBsZXQgc3JjcyA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKHdvcmQpO1xyXG4gICAgICAgIGxldCBlbmNyeXB0ZWQgPSBDcnlwdG9KUy5BRVMuZW5jcnlwdChzcmNzLCBrZXksIHsgaXY6IGl2LCBtb2RlOiBDcnlwdG9KUy5tb2RlLkNCQywgcGFkZGluZzogQ3J5cHRvSlMucGFkLlBrY3M3IH0pO1xyXG4gICAgICAgIGxldCByZXMgPSBlbmNyeXB0ZWQudG9TdHJpbmcoKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDloavlhYVcclxuICAgICAqIEBwYXJhbSBzdHIg5Y6f5aeL5a2X56ym5LiyXHJcbiAgICAgKiBAcGFyYW0gc2l6ZSDmnJ/mnJvplb/luqZcclxuICAgICAqL1xyXG4gICAgemZpbGwoc3RyLCBzaXplKSB7XHJcbiAgICAgICAgd2hpbGUgKHN0ci5sZW5ndGggPCBzaXplKSBzdHIgPSBcIjBcIiArIHN0cjtcclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUlNB5Yqg5a+GXHJcbiAgICAgKiBAcGFyYW0gdGV4dCDliqDlr4blhoXlrrlcclxuICAgICAqIEBwYXJhbSBwdWJLZXkg5YWs6ZKlXHJcbiAgICAgKiBAcGFyYW0gbW9kdWx1cyDlm7rlrprlgLxcclxuICAgICAqL1xyXG4gICAgcnNhRW5jcnlwdCh0ZXh0LCBwdWJLZXksIG1vZHVsdXMpIHtcclxuICAgICAgICBjb25zdCBfdGV4dCA9IHRleHQuc3BsaXQoJycpLnJldmVyc2UoKS5qb2luKCcnKTtcclxuICAgICAgICBjb25zdCBiaVRleHQgPSBCaWdJbnQoQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UoX3RleHQpLnRvU3RyaW5nKCksIDE2KSxcclxuICAgICAgICAgICAgYmlFeCA9IEJpZ0ludChwdWJLZXksIDE2KSxcclxuICAgICAgICAgICAgYmlNb2QgPSBCaWdJbnQobW9kdWx1cywgMTYpLFxyXG4gICAgICAgICAgICBiaVJldCA9IGJpVGV4dC5tb2RQb3coYmlFeCwgYmlNb2QpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnpmaWxsKGJpUmV0LnRvU3RyaW5nKDE2KSwgMjU2KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWKoOWvhueul+azleWFpeWPo1xyXG4gICAgICogQHBhcmFtIG9iaiDlvoXliqDlr4blr7nosaFcclxuICAgICAqL1xyXG4gICAgZW5jcnlwdChvYmopIHtcclxuICAgICAgICBjb25zdCB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcclxuICAgICAgICBjb25zdCBzZWNLZXkgPSB0aGlzLmNyZWF0ZVNlY3JldEtleSgxNik7XHJcbiAgICAgICAgbGV0IGZpcnN0UmVzID0gdGhpcy5hZXNFbmNyeXB0KHRleHQsIHRoaXMuZmlyc3RLZXkpO1xyXG4gICAgICAgIGNvbnN0IHNlY29uZFJlcyA9IHRoaXMuYWVzRW5jcnlwdChmaXJzdFJlcywgc2VjS2V5KTtcclxuICAgICAgICBjb25zdCBlbmNTZWNLZXkgPSB0aGlzLnJzYUVuY3J5cHQoc2VjS2V5LCB0aGlzLnB1YktleSwgdGhpcy5tb2R1bHVzKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwYXJhbXM6IHNlY29uZFJlcyxcclxuICAgICAgICAgICAgZW5jU2VjS2V5OiBlbmNTZWNLZXlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4iXX0=